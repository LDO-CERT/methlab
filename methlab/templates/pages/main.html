{% extends "base.html" %}
{% load render_table from django_tables2 %}
{% load static i18n leaflet_tags %}

{% block extra_css %}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
{% leaflet_js %}
{% leaflet_css %}
{% endblock extra_css %}

{% block container %}
<section class="py-5 text-center container">
  <div class="row py-lg-5">
    <div class="col-lg-6 col-md-8 mx-auto">
      <h1 class="font-weight-light">
        <img src="{% static 'images/meth.gif' %}" />
      </h1>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="card shadow-sm h-10">
        <div class="card-body">
          <h5 class="card-title">Email Analyzed</h5>
          <p><span style="font-size: 60px;">{{email_count}}</span></p>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Suspicious</h5>
          <p><span style="font-size: 60px;">{{suspicious}}</span></p>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Malicious</h5>
          <p><span style="font-size: 60px;">{{malicious}}</span></p>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="album py-5 bg-light">
  <div class="container">
    <script>
      function main_map_init(map, options) {
        var dataurl = '{% url "data" %}';
        $.getJSON(dataurl, function (data) {
          L.geoJson(data).addTo(map);
        });
      }
    </script>
    {% leaflet_map "worldmap" callback="main_map_init" %}
  </div>
</div>

<div class="album py-5 bg-light">
  <div class="container">
    <div class="row row-cols-1 row-cols-md-2 g-4">
      <div class="col-md-12">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <h5 class="card-title">Latest email</h5>
            {% render_table table_l %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock container %}